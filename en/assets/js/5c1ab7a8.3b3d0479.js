"use strict";(self.webpackChunkedna_docs=self.webpackChunkedna_docs||[]).push([["3531"],{81154:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>o,toc:()=>l,default:()=>d,metadata:()=>i,assets:()=>c,contentTitle:()=>s});var i=JSON.parse('{"id":"getting-started/lifecycle","title":"Integration into Application Lifecycle","description":"Description of ChatCenterUI SDK integration process with synchronization of main application (App Lifecycle) and SDK lifecycles.","source":"@site/i18n/en/docusaurus-plugin-content-docs-ios/version-5.6.0/getting-started/lifecycle.md","sourceDirName":"getting-started","slug":"/getting-started/lifecycle","permalink":"/en/ios/getting-started/lifecycle","draft":false,"unlisted":false,"tags":[],"version":"5.6.0","lastUpdatedAt":1769613525000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"mainSidebar","previous":{"title":"Installation","permalink":"/en/ios/getting-started/installation"},"next":{"title":"SDK Initialization and Configuration","permalink":"/en/ios/getting-started/init"}}'),r=t(85893),a=t(50065);let o={sidebar_position:3},s="Integration into Application Lifecycle",c={},l=[{value:"Overall Interaction Scheme",id:"overall-interaction-scheme",level:2},{value:"1. Application Launch",id:"1-application-launch",level:2},{value:"2. User Authorization",id:"2-user-authorization",level:2},{value:"3. Opening Chat",id:"3-opening-chat",level:2},{value:"4. User Logout",id:"4-user-logout",level:2}];function p(e){let n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"integration-into-application-lifecycle",children:"Integration into Application Lifecycle"})}),"\n",(0,r.jsx)(n.p,{children:"Description of ChatCenterUI SDK integration process with synchronization of main application (App Lifecycle) and SDK lifecycles."}),"\n",(0,r.jsx)(n.h2,{id:"overall-interaction-scheme",children:"Overall Interaction Scheme"}),"\n",(0,r.jsx)(n.p,{children:"The diagram below demonstrates how application lifecycle events should trigger corresponding SDK methods for typical integration."}),"\n",(0,r.jsx)(n.mermaid,{value:'sequenceDiagram\n    participant User as User\n    participant App as Application (App Lifecycle)\n    participant SDK as ChatCenterUI SDK\n    participant Backend as edna Server\n\n    Note over App, SDK: 1. Application Start (AppDelegate)\n    App->>SDK: Initialization (ChatCenterUISDK.init)\n    App->>SDK: Send push token (ChatCenterUISDK.setDeviceToken)\n    SDK--\x3e>App: Ready to work\n\n    Note over App, SDK: 2. User Authorization\n    User->>App: Enter login/password (PIN code)\n    SDK->>Backend: Request settings and history\n    Backend--\x3e>SDK: Data\n\n    App->>SDK: Set user (ChatCenterUISDK.authorize)\n\n    Note over App, SDK: 3. Using Chat\n    User->>App: Click "Support" button\n    App->>SDK: Create chat screen (ChatCenterUISDK.getChat)\n    SDK--\x3e>App: Return UIViewController\n    App->>User: Present chat screen (Present/Push)\n    SDK->>Backend: Request history and open WebSocket\n    Backend<<--\x3e>SDK: Data\n\n    Note over App, SDK: 4. Session Termination (Logout)\n    User->>App: Click "Logout"\n    App->>SDK: Clear session (logout / deauthorize)\n    SDK->>Backend: Unsubscribe from push and close socket\n    App->>User: Login screen'}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1-application-launch",children:"1. Application Launch"}),"\n",(0,r.jsxs)(n.p,{children:["SDK initialization should occur as early as possible, typically in ",(0,r.jsx)(n.code,{children:"application(_:didFinishLaunchingWithOptions:)"})," method. This is critical for correct operation and minimizing possible integration errors."]}),"\n",(0,r.jsx)(n.p,{children:"Creating ChatCenterUISDK instance happens very quickly and no network requests are performed during the process."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"AppDelegate.swift"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-swift",children:'import ChatCenterUI\n\nvar chatCenterSDK: ChatCenterUISDK?\n\nfunc application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n\n    // 1. Server connection configuration\n    let chatTransportConfig = ChatTransportConfig(\n        rest: "https://your-server.edna.ru",\n        webSocket: "wss://your-server.edna.ru",\n        dataStore: "https://your-server.edna.ru/files"\n    )\n\n    // 2. Chat configuration\n    let chatConfig = ChatConfig(transportConfig: chatTransportConfig)\n\n    // 3. SDK Initialization\n    // providerUid \u2014 unique application ID provided by edna\n    chatCenterSDK = ChatCenterUISDK(\n        providerUid: "YOUR_PROVIDER_UID",\n        chatConfig: chatConfig\n    )\n\n    return true\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-user-authorization",children:"2. User Authorization"}),"\n",(0,r.jsx)(n.p,{children:"After your application authorizes the user (e.g., login to authorized zone completed), you need to inform the SDK about user data. This allows loading chat history for specific client."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"AuthService.swift"})," / ",(0,r.jsx)(n.code,{children:"LoginViewModel.swift"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-swift",children:'func handleSuccessfulLogin(userId: String, userName: String?) {\n    guard let chatCenterSDK = (UIApplication.shared.delegate as? AppDelegate)?.chatCenterSDK else { return }\n\n    // Form user object\n    let chatUser = ChatUser(\n        identifier: userId,               // stable ID in your system\n        name: userName,                   // optional\n        data: ["segment": "premium"]      // optional, arbitrary attributes displayed in client profile\n    )\n\n    // Set user in SDK\n    chatCenterSDK.authorize(user: chatUser)\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-opening-chat",children:"3. Opening Chat"}),"\n",(0,r.jsxs)(n.p,{children:["To display chat interface, SDK provides ready-made ",(0,r.jsx)(n.code,{children:"UIViewController"}),". It can be shown modally or pushed to your navigation stack, etc."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"MainViewController.swift"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-swift",children:'@objc func openSupportChat() {\n    guard let chatCenterSDK = (UIApplication.shared.delegate as? AppDelegate)?.chatCenterSDK else { return }\n\n    // Get chat controller\n    let result = Result { try chatCenterSDK.getChat() }\n\n    switch result {\n    case let .success(chatController):\n        // Open chat screen\n\n        // Option A: Push (if NavigationController exists)\n        self.navigationController?.pushViewController(chatController, animated: true)\n\n        // Option B: Modal\n        // self.present(chatController, animated: true, completion: nil)\n    case let .failure(error):\n        // Error handling\n        switch error {\n        case ChatCenterUIError.userNotAuthorized:\n            print("User not set for chat")\n        case ChatCenterUIError.chatNotOpened:\n            print("Chat not opened")\n        default:\n            print("Chat opening error: \\(error)")\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-user-logout",children:"4. User Logout"}),"\n",(0,r.jsx)(n.p,{children:"When user logs out of application account, you need to terminate SDK session. This removes local data and unsubscribes device from push notifications for this user."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File:"})," ",(0,r.jsx)(n.code,{children:"ProfileViewModel.swift"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-swift",children:'func performLogout() {\n    guard let chatCenterSDK = (UIApplication.shared.delegate as? AppDelegate)?.chatCenterSDK else { return }\n\n    do {\n        // Clear user data and close connection\n        try chatCenterSDK.logout()\n        print("Chat SDK: Logged out successfully")\n    } catch {\n        print("Chat SDK: Logout error: \\(error)")\n    }\n\n    // Application authorization screen transition logic follows\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"If there is an authorized zone in the application (closed by PIN code entry) and it's necessary to terminate current session when exiting it, you can use deauthorizeUser() method for local user removal and stopping SDK network activity."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-swift",children:"func performLogout() {\n    guard let chatCenterSDK = (UIApplication.shared.delegate as? AppDelegate)?.chatCenterSDK else { return }\n    // Local user removal and connection closure\n    chatCenterSDK.deauthorizeUser()\n\n    // Application authorization screen transition logic follows\n}\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"When re-entering authorized zone, user must be set"})})]})}function d(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},50065:function(e,n,t){t.d(n,{Z:()=>s,a:()=>o});var i=t(67294);let r={},a=i.createContext(r);function o(e){let n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);