"use strict";(self.webpackChunkedna_docs=self.webpackChunkedna_docs||[]).push([["36006"],{57325:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>o,toc:()=>u,default:()=>f,metadata:()=>t,assets:()=>c,contentTitle:()=>d});var t=JSON.parse('{"id":"advanced/advanced","title":"Advanced Settings","description":"Logging","source":"@site/i18n/en/docusaurus-plugin-content-docs-ios/version-4.30.0/advanced/advanced.md","sourceDirName":"advanced","slug":"/advanced/","permalink":"/en/ios/4.30.0/advanced/","draft":false,"unlisted":false,"tags":[],"version":"4.30.0","lastUpdatedAt":1756120448000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"mainSidebar","previous":{"title":"\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u043D\u044B\u0435 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438","permalink":"/en/ios/4.30.0/category/\u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u043D\u044B\u0435-\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438"},"next":{"title":"Appearance and Behavior Customization","permalink":"/en/ios/4.30.0/advanced/ui"}}'),s=i(85893),r=i(50065),a=i(47902),l=i(5525);let o={sidebar_position:1},d="Advanced Settings",c={},u=[{value:"Logging",id:"logging",level:4},{value:"ThreadsDelegate",id:"threadsdelegate",level:3},{value:"Number of Unread Messages",id:"number-of-unread-messages",level:4},{value:"Errors Processing",id:"errors-processing",level:4},{value:"Opening Chat upon Tapping Push Notification",id:"opening-chat-upon-tapping-push-notification",level:4},{value:"Programmed Message Sending",id:"programmed-message-sending",level:3},{value:"Text Message",id:"text-message",level:4},{value:"Image",id:"image",level:4},{value:"Using Certificates",id:"using-certificates",level:3},{value:"SSL Pinning",id:"ssl-pinning",level:4},{value:"Working with Untrusted Certificates",id:"working-with-untrusted-certificates",level:4},{value:"Notifications about User Actions",id:"notifications-about-user-actions",level:3},{value:"API Version",id:"api-version",level:3},{value:"Disable User Input",id:"disable-user-input",level:3}];function h(e){let n={admonition:"admonition",code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"advanced-settings",children:"Advanced Settings"})}),"\n",(0,s.jsx)(n.h4,{id:"logging",children:"Logging"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Threads.threads().attributes.logLevels = .off"})," - Enables/disables logging. As a value, class LogLevel with support of the OptionSet(Swift) protocol or NS_OPTIONS(Objective-C) is used."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Possible values of LogLevel are as follows:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"off (all logging levels are disabled);"}),"\n",(0,s.jsx)(n.li,{children:"info (general level);"}),"\n",(0,s.jsx)(n.li,{children:"network (network level);"}),"\n",(0,s.jsx)(n.li,{children:"network-sock (network level, socket);"}),"\n",(0,s.jsx)(n.li,{children:"user-interface (user interface);"}),"\n",(0,s.jsx)(n.li,{children:"error (all);"}),"\n",(0,s.jsx)(n.li,{children:"all (all of the above levels are enabled);"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"    let logLevelValue = (LogLevel.network.rawValue | LogLevel.networkSock.rawValue)\n    Threads.threads().attributes.logLevels = LogLevel(rawValue: logLevelValue)\n"})}),"\n",(0,s.jsx)(n.p,{children:'If at least one log level is enabled, the event stream is sent to the system OSLog with the "im.threads.logs" identifier and can be observed through both the XCode terminal and the Console in macOS.'}),"\n",(0,s.jsxs)(n.p,{children:['Simultaneously with OSLog, events are recorded to a file on the device. Default name is Threads.log. Storage: .documentDirectory/Logs (NSSearchPathForDirectoriesInDomains(.documentDirectory, .userDomainMask, true) + "/Logs"). You can forcibly disable logging to a file on the device. To do this, pass ',(0,s.jsx)(n.code,{children:"nil"})," in the file name attribute settings:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"    Threads.threads().attributes.logFileName = nil \n"})}),"\n",(0,s.jsx)(n.p,{children:"Settings for the log recording file on the device:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:'Threads.threads().attributes.logFileName: String? = "Threads"'}),' - Log file name, default is "Threads" (if nil is passed, logs will not be recorded to the file);']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Threads.threads().attributes.logFileSizeMb: Int = 1"})," - Maximum file size in megabytes, by default - 1;"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Threads.threads().attributes.logFileMaxCount: Int = 7"})," - Maximum number of log files in rotation, by default - 7. If exceeded, the oldest one will be overwritten."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"threadsdelegate",children:"ThreadsDelegate"}),"\n",(0,s.jsx)(n.h4,{id:"number-of-unread-messages",children:"Number of Unread Messages"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"- (void)threads:(Threads *)threads unreadMessagesCount:(NSUInteger)unreadMessagesCount;"})}),"\n",(0,s.jsx)(n.h4,{id:"errors-processing",children:"Errors Processing"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"- (void)threads:(Threads *)threads didReceiveError:(NSError *)error;"})}),"\n",(0,s.jsx)(n.h4,{id:"opening-chat-upon-tapping-push-notification",children:"Opening Chat upon Tapping Push Notification"}),"\n",(0,s.jsxs)(n.p,{children:["To check whether the notification was opened by tapping a ",(0,s.jsx)(n.code,{children:"Threads"})," push notification, use the ",(0,s.jsx)(n.code,{children:"isThreadsOriginPushUserInfo"})," method:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",metastring:'title="AppDelegate.swift"',children:"extension AppDelegate: UNUserNotificationCenterDelegate {\n  @available(iOS 10.0, *)\n  func userNotificationCenter(_ center: UNUserNotificationCenter, didReceive response: UNNotificationResponse, withCompletionHandler completionHandler: @escaping () -> Void) {\n      // Check for application launched from notification\n      if response.actionIdentifier == UNNotificationDefaultActionIdentifier {\n          let userInfo = response.notification.request.content.userInfo\n          if Threads.threads().isThreadsOriginPushUserInfo(userInfo) {\n              // Application launched from Threads notification\n          } else {\n              // Application launched from other notifications\n          }\n      }\n      completionHandler()\n  } \n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"programmed-message-sending",children:"Programmed Message Sending"}),"\n",(0,s.jsx)(n.h4,{id:"text-message",children:"Text Message"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let text = "Hello, World!"\n\nThreads.threads().sendMessage(withText: text) { [weak self] (error) in\n  if let error = error {\n      // handle error\n  } else {\n      // handle success		\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"Limitation: 4,000 characters."}),(0,s.jsxs)(n.p,{children:["Use example:\xa0",(0,s.jsx)(n.code,{children:"TextMessageSwiftViewController.swift"}),",\xa0",(0,s.jsx)(n.code,{children:"TextMessageObjcViewController.m"})]})]}),"\n",(0,s.jsx)(n.h4,{id:"image",children:"Image"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'let image = UIImage(named: "helloWorld")\n\nThreads.threads().sendMessage(with: image) { [weak self] (error) in\n  if let error = error {\n      // handle error\n  } else {\n      // handle success		\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"Limit by default: 30 MB"}),(0,s.jsxs)(n.p,{children:["See the use example in ",(0,s.jsx)(n.code,{children:"PictureMessageSwiftViewController.swift"})," and ",(0,s.jsx)(n.code,{children:"PictureMessageObjcViewController.m"})]})]}),"\n",(0,s.jsx)(n.h3,{id:"using-certificates",children:"Using Certificates"}),"\n",(0,s.jsx)(n.h4,{id:"ssl-pinning",children:"SSL Pinning"}),"\n",(0,s.jsxs)(n.p,{children:["It allows you to use a specified list of certificates to check whether they match the certificates on the server. The certificates themselves must be enclosed in the application bundle in the DER encoding.\nIf the list is not empty, the\xa0",(0,s.jsx)(n.code,{children:"allowUntrustedSSLCertificate"}),"\xa0setting will be ignored."]}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsx)(n.p,{children:"When utilizing this functionality, we do not recommend using only one certificate. If it is revoked or expired, SDK will stop connecting to the server. Use backup certificates and update them timely."})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"[Threads threads].attributes.trustedCertificates"})," - An empty array by default."]}),"\n"]}),"\n",(0,s.jsxs)(a.Z,{groupId:"ios-language",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Objective-C",value:"objective-c"}],children:[(0,s.jsx)(l.Z,{value:"swift",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:'Threads.threads().attributes.trustedCertificates = [\n 	THRCert(contentsOf: Bundle.main.url(forResource: "GUTS_2022.cer", withExtension: nil)),\n	THRCert(contentsOf: Bundle.main.url(forResource: "guts.2022.cer", withExtension: nil)),\n	THRCert(contentsOfFile: "guts_22.cer"),\n	THRCert(contentsOfFile: "guts.22.cer")\n'})})}),(0,s.jsx)(l.Z,{value:"objective-c",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectivec",children:'[Threads threads].attributes.trustedCertificates = @[\n	[[THRCert alloc] initWithContentsOf: [NSBundle.mainBundle URLForResource:@"GUTS_2022.cer" withExtension:nil]],\n	[[THRCert alloc] initWithContentsOf: [NSBundle.mainBundle URLForResource:@"guts.2022.cer" withExtension:nil]],\n	[[THRCert alloc] initWithContentsOfFile:@"guts_22.cer"],\n	[[THRCert alloc] initWithContentsOfFile:@"guts.22.cer"]\n];\n'})})})]}),"\n",(0,s.jsx)(n.h4,{id:"working-with-untrusted-certificates",children:"Working with Untrusted Certificates"}),"\n",(0,s.jsxs)(n.p,{children:["It regulates validation of server certificates in the SDK. If the ",(0,s.jsx)(n.code,{children:"trustedCertificatesList"})," setting is activated, this setting is ignored and the exact compliance of certificates from the specified list is checked."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"[Threads threads].attributes.allowUntrustedSSLCertificate = [YES | NO]"}),"\xa0- Disabled by default."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"notifications-about-user-actions",children:"Notifications about User Actions"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:'"Threads.Controls.DidClickCloseButton"'})," - Notification sent when the user clicks on the chat close button."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"api-version",children:"API Version"}),"\n",(0,s.jsx)(n.p,{children:"Allow to set API version for working with servers. Possible values are in enum THRAPIVersion [api15 | api17 | api18]."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"`Threads.threads.apiVersion - Default value is api15."}),"\n"]}),"\n",(0,s.jsxs)(a.Z,{groupId:"ios-language",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Objective-C",value:"objective-c"}],children:[(0,s.jsx)(l.Z,{value:"swift",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"Threads.threads.apiVersion = THRAPIVersion.api18\n"})})}),(0,s.jsx)(l.Z,{value:"objective-c",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectivec",children:"[Threads threads].apiVersion = THRAPIVersionApi18;\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"disable-user-input",children:"Disable User Input"}),"\n",(0,s.jsx)(n.p,{children:"Disable ability of user input and sending messages to chat."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-swift",children:"Threads.threads.disableUserInput = true\n"})})]})}function f(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},5525:function(e,n,i){i.d(n,{Z:()=>r});var t=i(85893);i(67294);var s=i(67026);function r({children:e,hidden:n,className:i}){return(0,t.jsx)("div",{role:"tabpanel",className:(0,s.Z)("tabItem_Ymn6",i),hidden:n,children:e})}},47902:function(e,n,i){i.d(n,{Z:()=>x});var t=i(85893),s=i(67294),r=i(67026),a=i(69599),l=i(16550),o=i(32e3),d=i(4520),c=i(38341),u=i(76009);function h(e){return s.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,s.isValidElement)(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function f({value:e,tabValues:n}){return n.some(n=>n.value===e)}var g=i(7227);function p({className:e,block:n,selectedValue:i,selectValue:s,tabValues:l}){let o=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.o5)(),c=e=>{let n=e.currentTarget,t=l[o.indexOf(n)].value;t!==i&&(d(n),s(t))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{let i=o.indexOf(e.currentTarget)+1;n=o[i]??o[0];break}case"ArrowLeft":{let i=o.indexOf(e.currentTarget)-1;n=o[i]??o[o.length-1]}}n?.focus()};return(0,t.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},e),children:l.map(({value:e,label:n,attributes:s})=>(0,t.jsx)("li",{role:"tab",tabIndex:i===e?0:-1,"aria-selected":i===e,ref:e=>{o.push(e)},onKeyDown:u,onClick:c,...s,className:(0,r.Z)("tabs__item","tabItem_LNqP",s?.className,{"tabs__item--active":i===e}),children:n??e},e))})}function m({lazy:e,children:n,selectedValue:i}){let a=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){let e=a.find(e=>e.props.value===i);return e?(0,s.cloneElement)(e,{className:(0,r.Z)("margin-top--md",e.props.className)}):null}return(0,t.jsx)("div",{className:"margin-top--md",children:a.map((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==i}))})}function v(e){let n=function(e){let{defaultValue:n,queryString:i=!1,groupId:t}=e,r=function(e){let{values:n,children:i}=e;return(0,s.useMemo)(()=>{let e=n??h(i).map(({props:{value:e,label:n,attributes:i,default:t}})=>({value:e,label:n,attributes:i,default:t})),t=(0,c.lx)(e,(e,n)=>e.value===n.value);if(t.length>0)throw Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`);return e},[n,i])}(e),[a,g]=(0,s.useState)(()=>(function({defaultValue:e,tabValues:n}){if(0===n.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!f({value:e,tabValues:n}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}let i=n.find(e=>e.default)??n[0];if(!i)throw Error("Unexpected error: 0 tabValues");return i.value})({defaultValue:n,tabValues:r})),[p,m]=function({queryString:e=!1,groupId:n}){let i=(0,l.k6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,d._X)(t),(0,s.useCallback)(e=>{if(!t)return;let n=new URLSearchParams(i.location.search);n.set(t,e),i.replace({...i.location,search:n.toString()})},[t,i])]}({queryString:i,groupId:t}),[v,x]=function({groupId:e}){let n=e?`docusaurus.tab.${e}`:null,[i,t]=(0,u.Nk)(n);return[i,(0,s.useCallback)(e=>{n&&t.set(e)},[n,t])]}({groupId:t}),j=(()=>{let e=p??v;return f({value:e,tabValues:r})?e:null})();return(0,o.Z)(()=>{j&&g(j)},[j]),{selectedValue:a,selectValue:(0,s.useCallback)(e=>{if(!f({value:e,tabValues:r}))throw Error(`Can't select invalid tab value=${e}`);g(e),m(e),x(e)},[m,x,r]),tabValues:r}}(e);return(0,t.jsxs)("div",{className:(0,r.Z)("tabs-container","tabList__CuJ"),children:[(0,t.jsx)(p,{...n,...e}),(0,t.jsx)(m,{...n,...e})]})}function x(e){let n=(0,g.Z)();return(0,t.jsx)(v,{...e,children:h(e.children)},String(n))}},50065:function(e,n,i){i.d(n,{Z:()=>l,a:()=>a});var t=i(67294);let s={},r=t.createContext(s);function a(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);