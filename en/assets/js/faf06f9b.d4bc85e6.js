"use strict";(self.webpackChunkedna_docs=self.webpackChunkedna_docs||[]).push([["33880"],{90148:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>o,toc:()=>c,default:()=>h,metadata:()=>i,assets:()=>d,contentTitle:()=>r});var i=JSON.parse('{"id":"Widget_installation","title":"Widget installation","description":"Widget code","source":"@site/i18n/en/docusaurus-plugin-content-docs-web/version-6.29.0/Widget_installation.md","sourceDirName":".","slug":"/Widget_installation","permalink":"/en/web/6.29.0/Widget_installation","draft":false,"unlisted":false,"tags":[],"version":"6.29.0","lastUpdatedAt":1758185487000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"mainSidebar","previous":{"title":"Getting Started","permalink":"/en/web/6.29.0/Getting_started"},"next":{"title":"Structure of edna Web chat SDK","permalink":"/en/web/6.29.0/Structure_of_edna_Web_chat_SDK"}}'),a=t(85893),s=t(50065);let o={sidebar_position:3},r="Widget installation",d={},c=[{value:"Widget code",id:"widget-code",level:3},{value:"Settings file",id:"settings-file",level:3},{value:"Widget configuration",id:"widget-configuration",level:3},{value:"Connection to external edna API and datastore",id:"connection-to-external-edna-api-and-datastore",level:4},{value:"Authorized and unauthorized zones",id:"authorized-and-unauthorized-zones",level:4},{value:"Extended authorization (optional)",id:"extended-authorization-optional",level:3},{value:"Chat launch",id:"chat-launch",level:3}];function l(e){let n={a:"a",code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"widget-installation",children:"Widget installation"})}),"\n",(0,a.jsx)(n.h3,{id:"widget-code",children:"Widget code"}),"\n",(0,a.jsxs)(n.p,{children:["On the web page where you want the chat to be displayed, add the following code before the closing tag ",(0,a.jsx)(n.code,{children:"</body>"})," to enable the chat widget:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-markup",children:'\x3c!-- BEGIN CHAT {literal} --\x3e\n<script type="text/javascript">\n  !function(e,a){"use strict";window.ThreadsWidget={},e=e||"/settings.json";function n(e,t){const n=setInterval(function(){ThreadsWidget&&!ThreadsWidget.isDummy&&(clearInterval(n),ThreadsWidget[e]&&ThreadsWidget[e].apply(void 0,t))},100)}ThreadsWidget.isDummy=!0,["hideInvite","version","commitHash","showChat","hideChat","onHideChat","onScenarios","onLoad","on","reInit","init","unInit"].forEach(t=>{ThreadsWidget[t]=(...e)=>{n(t,e)}});const t=function(){const i=new XMLHttpRequest;return function(e,t,n,a){i.onreadystatechange=function(){if(4===i.readyState)if(200===this.status)n(i.response);else{if("function"!=typeof a)throw new Error(i.response);a(i)}},i.open(e,t),i.send()}}();function i(t){t.webchat&&(t.webchat.filename=t.filename),a&&"string"==typeof a&&(t.webchat.currentLocale=a),a&&"object"==typeof a&&(a.locale&&"string"==typeof a.locale&&(t.webchat.currentLocale=a.locale),a.unavailable&&"boolean"==typeof a.unavailable&&(t.webchat.isUnavailableOnStart=a.unavailable));try{sessionStorage.setItem("__threadsWidget",JSON.stringify(t.webchat))}catch(e){window.__threadsWidget=JSON.stringify(t.webchat)}if(t.filename){const e=document.createElement("script"),n=(e.type="text/javascript",e.async=!0,e.src=t.filename,document.getElementsByTagName("script")[0]);n?n.parentNode.insertBefore(e,n):document.body.appendChild(e)}else console.error("Invalid bundle")}function o(){t("GET",e+"?rnd="+Math.random(),function(e){const t=JSON.parse(e);i(t)})}"complete"===document.readyState?o():window.addEventListener("DOMContentLoaded",o,!1)}("settings.json",{});\n<\/script>\n\x3c!-- {/literal} END CHAT --\x3e\n'})}),"\n",(0,a.jsx)(n.h3,{id:"settings-file",children:"Settings file"}),"\n",(0,a.jsxs)(n.p,{children:["Place the ",(0,a.jsx)(n.code,{children:"settings.json"})," file on your website so that this file is available on ",(0,a.jsx)(n.code,{children:"http(s)://your.site.ru/your/path/to/settings.json"}),". We recommend that you place the file to the same directory where the **_.js chat files are located."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"IMPORTANT!"}),"\nThe path to the settings file ",(0,a.jsx)(n.code,{children:"settings.json"})," is set at the end of the initialization script:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'... ("settings.json")\n'})}),"\n",(0,a.jsx)(n.p,{children:"As the value for this parameter, use the absolute path from the root of your website. Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:"('/your/path/to/settings.json');\n"})}),"\n",(0,a.jsx)(n.p,{children:"If necessary, you can set additional parameters during the initial initialization."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:"'/your/path/to/settings.json',\n  {\n    locale: 'en',\n    unavailable: true,\n  };\n"})}),"\n",(0,a.jsx)(n.p,{children:"where:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"locale"})," - Locale language"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"unavailable"})," - Widget unavailability (",(0,a.jsx)(n.code,{children:"true"})," if unavailable). If ",(0,a.jsx)(n.code,{children:"unavailable"})," is set to ",(0,a.jsx)(n.code,{children:"true"}),", the chat will be hidden after the chat page loads, unless the client has an active thread."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"widget-configuration",children:"Widget configuration"}),"\n",(0,a.jsxs)(n.p,{children:["The chat settings are stored in the provided ",(0,a.jsx)(n.code,{children:"settings.json"})," file. The file contains file storage connection data, appearance theme settings, connection settings, and API keys you need to use for edna API."]}),"\n",(0,a.jsx)(n.h4,{id:"connection-to-external-edna-api-and-datastore",children:"Connection to external edna API and datastore"}),"\n",(0,a.jsxs)(n.p,{children:["The settings are unique for each new connection. In the examples of edna SDK they are set to ",(0,a.jsx)(n.code,{children:'"FIX_ME"'})," and you must edit them before the launch. You must do it for the following parameters:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"webchat/package = <application_package>"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"webchat/uid = <application_uid>"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"webchat/websocket = <push server websocket URL>"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"webchat/datastore = <datastore URL>"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"webchat/backend/history = <datastore history URL>"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"webchat/backend/rootUrl = <datastore API URL>"})}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"You will get the values of these parameters from the deployment manager."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Note:"})," In case of on-premise deployment of edna Datastore, the parameters ",(0,a.jsx)(n.code,{children:"webchat/datastore"}),", ",(0,a.jsx)(n.code,{children:"webchat/backend/history"})," and ",(0,a.jsx)(n.code,{children:"webchat/backend/rootUrl"})," depend on the address of the installed edna Datastore."]}),"\n",(0,a.jsx)(n.h4,{id:"authorized-and-unauthorized-zones",children:"Authorized and unauthorized zones"}),"\n",(0,a.jsx)(n.p,{children:"The chat widget can be in one of the two modes:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Guest mode"}),". The time of the user session existence are defined by the parameters in ",(0,a.jsx)(n.code,{children:"settings.json"}),". ",(0,a.jsx)(n.code,{children:"webchat/backend/unauthorizedHistory"}),". For example:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'{\n  "cookie": {"Max-Age": 15552000}\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"where:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Max-Age"})," - Time in second of history storing for the site users"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["The session identifier is stored in cookie, the storing parameters are configured in the ",(0,a.jsx)(n.code,{children:"webchat/backend/unauthorizedHistory/cookie"})," object, where the key corresponds to the specifications of the cookie directives."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Authorized mode"}),'. The mode can be activated for an authorized website user by passing the unique user identifier to the chat to create a link "edna client" - "website user". The session of such a user is not linked to the current browser tab, the user will see the chat history on any tab where the chat is open. Set the parameter ',(0,a.jsx)(n.code,{children:"clientId"})," in the ",(0,a.jsx)(n.code,{children:"settings.json"})," file in the global JavaScript object ",(0,a.jsx)(n.a,{href:"https://developer.mozilla.org/ru/docs/Web/API/Window",children:"window"})," to pass the unique identifier of the authorized user to the chat. Do this before the chat initialization. The string in the ",(0,a.jsx)(n.code,{children:"settings.json"})," (in its simplest form) can look as follows:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'"clientId": "clientId",\n'})}),"\n",(0,a.jsxs)(n.p,{children:["This way, if you decide to place the unique user identifier in the property of the ",(0,a.jsx)(n.code,{children:"window"})," object, which you decide to name ",(0,a.jsx)(n.code,{children:"clientId"})," (as in the example above), insert the following string before the initialization code:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:"window.clientId = 'user identifier';\n"})}),"\n",(0,a.jsxs)(n.p,{children:["You can pass additional client data the same way (in the JSON format). This client data will be displayed in the client information in the agent WP. To do this, in the ",(0,a.jsx)(n.code,{children:"clientData"})," parameter of ",(0,a.jsx)(n.code,{children:"settings.json"}),", set the name of the property, in which you will pass the client's details. Usually, the name is left the same - ",(0,a.jsx)(n.code,{children:"clientData"})," - as in the example below:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'"clientData": "clientData",\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Then, in the global JavaScript object ",(0,a.jsx)(n.code,{children:"window"}),", set the value of this property. To do this, insert the following string before the initialization code:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:"window.clientData = `<client data>`;\n"})}),"\n",(0,a.jsxs)(n.p,{children:["where ",(0,a.jsx)(n.code,{children:"<client data>"})," is a JSON object converted into a string. As you see in the example, the data is passed in ",(0,a.jsx)(n.code,{children:"window.clientData"}),", as ",(0,a.jsx)(n.code,{children:"clientData"})," was set as the name of the property.\nFollowing is an example of passing the client details that consist of ",(0,a.jsx)(n.code,{children:"name"}),", ",(0,a.jsx)(n.code,{children:"phone"}),", ",(0,a.jsx)(n.code,{children:"email"}),", ",(0,a.jsx)(n.code,{children:"personal_manager"}),", and ",(0,a.jsx)(n.code,{children:"customField"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'window.clientData =\n  \'{"name":"Name Surname","phone":"+7-999-999-99-99","email":"e@mail.com","personal_manager":"login","customField":"customValue"}\';\n'})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"NOTE"}),": The examples in the SDK contain all necessary settings."]}),"\n",(0,a.jsx)(n.h3,{id:"extended-authorization-optional",children:"Extended authorization (optional)"}),"\n",(0,a.jsxs)(n.p,{children:["Optionally, you can pass additional parameters in requests to the server. For these settings, use the ",(0,a.jsx)(n.code,{children:"extendedAuth"})," section of the parameters in ",(0,a.jsx)(n.code,{children:"settings.json"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"dataKey"})," parameter is a string that contains the name of the property in the global JavaScript object ",(0,a.jsx)(n.code,{children:"window"})," that stores the object with extended data for authorization.\nThe parameter is optional, its default value is ",(0,a.jsx)(n.code,{children:"extendedAuth"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:"window.extendedAuth = <JSON data>;\n"})}),"\n",(0,a.jsx)(n.p,{children:"For example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "custom-property": "value for custom header",\n  "token": "some token value",\n  "type": "token type"\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"http.enabled"})," parameter enables or disables the extended authorization mode for HTTP(S)-requests (",(0,a.jsx)(n.code,{children:"boolean"}),").\nThe ",(0,a.jsx)(n.code,{children:"http.headersMap"})," parameter is an object whose keys are the names of the headers passed in HTTP(S)-requests, and their values are the names of the properties from the extended data object. This way, you can configure any number of optional headers."]}),"\n",(0,a.jsx)(n.p,{children:"For example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'"extendedAuth": {\n    "dataKey": "extendedAuth",\n    "http": {\n        "enabled": true,\n        "headersMap": {\n            "Header-Name": "custom-property",\n            "X-Auth-Token": "token",\n            "X-Token-Type": "type"\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Example of a request with extended authorization headers:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"GET /some/backend/url\nHost: example.com\nContent-Type: application/json\nHeader-Name: value for custom header\nX-Auth-Token: some token value\nX-Token-Type: token type\n...\n"})}),"\n",(0,a.jsx)(n.h3,{id:"chat-launch",children:"Chat launch"}),"\n",(0,a.jsx)(n.p,{children:"Once you save the settings, open the webpage with the tab with the chat in your browser. You will see the chat button in the right bottom corner. Once you click it, the start chat window opens (img. 1)."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Img. 1. Start chat window",src:t(40609).Z+"",width:"360",height:"540"})}),"\n",(0,a.jsx)(n.p,{children:"Img. 1. Start chat window"})]})}function h(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},40609:function(e,n,t){t.d(n,{Z:()=>i});let i=t.p+"assets/images/welcome-7b478cc82d46103d653fbe5cf9f823c3.png"},50065:function(e,n,t){t.d(n,{Z:()=>r,a:()=>o});var i=t(67294);let a={},s=i.createContext(a);function o(e){let n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);